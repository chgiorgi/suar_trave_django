{% extends 'base.html' %}
{% load bootstrap4 %}
{% block content %}
    <div class="site-section" data-aos="fade-up">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 mb-5 mb-md-0">

                    {% for img in single_tour.images.all %}
                        {% if img.is_main %}
                            <h1><img src="{{ img.image.url }}" alt="img" class="img-fluid"></h1>
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="col-md-6 pl-md-5">
                    <h1 class="font-weight-light text-black mb-4">{{ single_tour.title }}</h1>

                    <h3>{{ single_tour.destination }}</h3>
                    <h3>{{ single_tour.duration }}</h3>
                    <p>{{ single_tour.description }}</p>
                    <h3>{{ single_tour.price }}</h3>
                </div>

            </div>
        </div>
    </div>



    <div class="site-section" data-aos="fade-up">

        <div class="container">
            <h1 class="text-center">Tour Gallery</h1>
            <br>
            <div class="row">
                {% for img in single_tour.images.all %}
                    <div class="col-md-6 col-lg-4 mb-4 mb-lg-4">
                        <h1><img src="{{ img.image.url }}" alt="img" class="img-fluid"></h1>
                    </div>
                {% endfor %}

            </div>
        </div>
    </div>
    <div class="site-section" data-aos="fade-up">
        <div class="container">

            <ul>

                {% for cmnt in single_tour.comments.all %}


                    <div class="row">
                        <li class="mr-md-0">{{ cmnt.user }}:</li>
                        <li id="old_com" class="mr-auto">{{ cmnt.text }}</li>
                        <div>

                            {% if user.is_authenticated and cmnt.user == user %}

                                <input type="submit" id="editform" value="edit">
                                <div id="com_form" class="edit-cmnt">
                                    <form method="post" action="{% url 'tours:edit_comment' pk=cmnt.id slug=single_tour.slug %}">

                                        {% csrf_token %}

                                        <input type="text" value="{{ cmnt.text }}">
                                        <input type="submit" name="submit" value="Submit">
                                    </form>
                                </div>


                                <form method="post"
                                      action="{% url 'tours:del_comment' pk=cmnt.id slug=single_tour.slug %}">

                                    {% csrf_token %}
                                    <input type="submit" name="delete" value="Delete"
                                           class="text-danger" aria-hidden="true"/>
                                </form>

                            {% endif %}

                        </div>
                    </div>
                {% endfor %}
            </ul>
        </div>
    </div>


    {% if success %}
        <h2>Comment Added Successfully</h2>
    {% elif error %}
        <h2>{{ error }}</h2>
    {% else %}

        <div class="site-section" data-aos="fade-up">
            <div class="container">
                <h1>Comments</h1>
                <h1> {{ single_tour.slug }}</h1>
                <form id="post_form" method="post" action="{% url 'tours:comment' slug=single_tour.slug %}"
                      enctype="multipart/form-data">

                    {% csrf_token %}

                    {% bootstrap_form tour_comments %}

                    <input type="submit" name="submit" value="Submit"/>
                </form>
            </div>
        </div>
    {% endif %}




{% endblock %}
