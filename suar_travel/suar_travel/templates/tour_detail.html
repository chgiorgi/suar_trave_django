{% extends 'base.html' %}
{% load bootstrap4 %}
{% block content %}
<div class="site-section" data-aos="fade-up">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6 mb-5 mb-md-0">

                {% for img in single_tour.images.all %}
                {% if img.is_main %}
                <h1><img src="{{ img.image.url }}" alt="img" class="img-fluid"></h1>
                {% endif %}
                {% endfor %}
            </div>
            <div class="col-md-6 pl-md-5">
                <h1 class="font-weight-light text-black mb-4">{{ single_tour.title }}</h1>

                <h3>{{ single_tour.destination }}</h3>
                <h3>{{ single_tour.duration }}</h3>
                <p>{{ single_tour.description }}</p>
                <h3>{{ single_tour.price }}</h3>
            </div>

        </div>
    </div>
</div>


<div class="site-section" data-aos="fade-up">

    <div class="container">
        <h1 class="text-center">Tour Gallery</h1>
        <br>
        <div class="row">
            {% for img in single_tour.images.all %}
            <div class="col-md-6 col-lg-4 mb-4 mb-lg-4">
                <h1><img src="{{ img.image.url }}" alt="img" class="img-fluid"></h1>
            </div>
            {% endfor %}

        </div>
    </div>
</div>
<div class="site-section" data-aos="fade-up">
    <div class="container">
        <div class="row align-self-auto">
            <h1 style="margin: auto">Comments</h1>
        </div>
        <ul class="comm-lst">
            {% for cmnt in single_tour.comments.all %}
            <li class="col comm-item">
                <span class="col-12 user-name"><b>{{ cmnt.user }}:</b></span>
                <div class="row comm-body">
                    <span class="col-10 cmnt-text">{{ cmnt.text }}</span>
                    <i class="fas fa-pencil-alt  com-edit-ic on-hover action-btn"
                       onclick="showEditForm({{cmnt.id}})"> </i>
                    <i class="fas fa-trash-alt  com-edit-ic on-hover action-btn" onclick="onDelete({{cmnt.id}})"> </i>
                    <form class="col-1 delete-form"
                          method="post"
                          id="delete_{{cmnt.id}}"
                          action="{% url 'tours:del_comment' pk=cmnt.id slug=single_tour.slug %}">

                        {% csrf_token %}
                        <input type="submit" name="delete" value="Delete"
                               class="text-danger" aria-hidden="true"/>
                    </form>
                </div>
            </li>
            <!--<li class="mr-md-0">{{ cmnt.user }}:</li>-->
            <!--<li id="old_com" class="mr-auto">{{ cmnt.text }}</li>-->
            <div>

                {% if user.is_authenticated and cmnt.user == user %}

                <div id={{cmnt.id}} class="comment-edit-form">
                    <form method="post" action="{% url 'tours:edit_comment' pk=cmnt.id slug=single_tour.slug %}">

                        {% csrf_token %}

                        <input type="text" value="{{ cmnt.text }}">
                        <input type="submit" name="submit" value="Submit">
                    </form>
                </div>


                {% endif %}

            </div>
            {% endfor %}
        </ul>
    </div>

    <div class="container" style="margin-top: 32px">
        {% if success %}
        <h4>Comment Added Successfully</h4>
        {% elif error %}
        <h4>{{ error }}</h4>
        {% else %}
        <h3>Add Comment</h3>
        <form id="post_form row" method="post" action="{% url 'tours:comment' slug=single_tour.slug %}"
              enctype="multipart/form-data">

            {% csrf_token %}
            <div class="col-md-10 col-sm-12">
                {% bootstrap_form tour_comments %}
            </div>
            <input class="btn btn-light" type="submit" name="submit" value="Submit"/>
        </form>
    </div>
    {% endif %}

</div>


{% endblock %}
